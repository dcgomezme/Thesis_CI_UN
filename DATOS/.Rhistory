geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.5, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Concrete")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "BuPu", name = "Areas") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Concrete")
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.5, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Concrete")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlOrBr", name = "Areas") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Concrete")
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.5, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Concrete")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Areas") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Concrete")
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.5, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Concrete")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Concrete")
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.8, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Concrete")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Concrete")
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.2, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Concrete")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Concrete")
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Concrete")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Concrete")
library(tidyverse)
library(ggplot2)
library(showtext)
font_files() %>% tibble() %>% filter(str_detect("CMU", family))
font_files() %>% tibble() %>% filter(str_detect(family, "CMU"))
font_files() %>% tibble() %>% filter(str_detect(family, "CMU")) %>% pint(n = 33)
font_files() %>% tibble() %>% filter(str_detect(family, "CMU")) %>% print(n = 33)
font_add(family = "CMU Serfi", regular = "cmunrm.ttf")
showtext_auto()
pc <- c(68.7, 1.2, 30.1)
ar <- c("Ice and snow", "Geographic Areas", "Groundwater")
ar <- ar[order(pc)]; pc <- sort(pc)
ar.factor <- factor(ar, levels = as.character(ar))
ypos <- cumsum(pc) - 0.5 * pc
ypos <- 100 - ypos
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
font_add(family = "CMU Serfi", regular = "cmunbi.ttf")
showtext_auto()
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
font_add(family = "CMU Serfi", regular = "cmunbl.ttf")
showtext_auto()
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
font_add(family = "CMU Serfi", regular = "cmunsl.ttf")
showtext_auto()
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
font_add(family = "CMU Serif", regular = "cmunbi.ttf")
showtext_auto()
pc <- c(68.7, 1.2, 30.1)
ar <- c("Ice and snow", "Geographic Areas", "Groundwater")
ar <- ar[order(pc)]; pc <- sort(pc)
ar.factor <- factor(ar, levels = as.character(ar))
ypos <- cumsum(pc) - 0.5 * pc
ypos <- 100 - ypos
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
font_add(family = "CMU Serif", regular = "cmunbl.ttf")
showtext_auto()
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
font_add(family = "CMU Serif", regular = "cmunbx.ttf")
showtext_auto()
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
font_add(family = "CMU Serif", regular = "cmunrm.ttf")
showtext_auto()
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
font_add(family = "CMU Serif", regular = "cmunrb.ttf")
showtext_auto()
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
font_add(family = "CMU Serif", regular = "cmunrm.ttf")
showtext_auto()
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
font_add(family = "CMU Serif", regular = "cmunsl.ttf")
showtext_auto()
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
font_add(family = "CMU Serif", regular = "cmunti.ttf")
showtext_auto()
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
font_add(family = "CMU Serif", regular = "cmunrm.ttf")
showtext_auto()
ggplot() + theme_bw() +
geom_bar(aes(x = "", y = pc, fill = ar.factor),
stat = "identity", color = "white") +
coord_polar("y", start = 0) +
ggtitle("Distribution of fresh drinking  water") +
theme(plot.title = element_text(hjust = 0.1, size = 20),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
panel.border = element_blank(),
text = element_text(family = "CMU Serif")) +
guides(fill = guide_legend(reverse = TRUE)) +
scale_fill_brewer(palette = "YlGnBu", name = "Zones") +
theme(legend.text = element_text(size = 15),
legend.title = element_text(hjust = 0.5, size = 18),
legend.key.size = unit(1, "cm")) +
geom_text(aes(x = "", y = ypos, label = paste0(pc, "%")),
size = 6, family = "CMU Serif")
install.packages("devtools")
devtools::install_github("dazamora/IDFtool")
library(IDFtool)
E23195180 <- read.csv2("C:/Users/David Gomez/Desktop/IDF/E23195180.csv")
class(E27045020)
class(E23195180)
str(E23195180)
View(E23195180)
E23195180
sapply(E23195180, class)
sapply(E23195180, class)
chars <- sapply(E23195180, is.character)
E23195180[ , chars] <- as.data.frame(apply(E23195180[ , chars], 2,
as.numeric))
sapply(E23195180, class)
E23195180 <- as.matrix(E23195180)
Test.idftool <- IDFCurve(Data = E23195180, Station='E23195180', Duration = FALSE,
Periods = FALSE, Type = "gumbel", M.fit ="lmoments",
Plot = 3, Strategy = 1, logaxe = "", CI = FALSE,
CIpdf = TRUE, iter = 50, goodtest = FALSE,
Resolution = 300, SAVE = TRUE, name = TRUE)
Test.idftool <- IDFCurve(Data = E23195180, Station='E23195180', Duration = FALSE,
Periods = FALSE, Type = "gumbel", M.fit ="lmoments",
Plot = 3, Strategy = 1, logaxe = "", CI = FALSE,
CIpdf = TRUE, iter = 50, goodtest = FALSE,
Resolution = 300, SAVE = TRUE, name = TRUE)
#------------------------------TESIS_CODE--------------------------------------
rm(list = ls()) #Clear the work space
#Load required packages
library(readxl) #Allows to read xls or xlsx files
library(openxlsx) #Read, write and edit xlsx files
library(xts) #eXtensible Time Series
library(data.table) #Fast aggregation of large data
library(tidytable) #A tidy interface to 'data.table'
library(lubridate) #Make dealing with dates a little easier
library(tidyverse) #Set of packages that work in harmony
#Defining the working directory
setwd("C:/Users/David Gomez/Desktop/TESIS/DATOS")
#Function to be able to discard stations without data - precipitation
agg <- function(x) {
if (sum(is.na(x)) >= 0.25 * length(x)) { #defined percentage
return(NA)
}
else {
return(sum(x, na.rm = TRUE))
}
}
#Reading precipitation information
data_ppt <- read.xlsx("DatosIDW_221205.xlsx", "PTPM_CON")
#Sorting the precipitation data by dates
data_ppt <- as.xts(data_ppt[ , -1],
order.by = as.Date(data_ppt[ , 1],
format = "%Y-%m-%d"))
#Obtaining the annual precipitation of each station
data_y_ppt <- aggregate(data_ppt, by = year(index(data_ppt)), agg) %>%
data.frame(check.names = FALSE)
#Function to be able to discard stations without data - temperature
agg_mt <- function(x) {
if (sum(is.na(x)) >= 0.25 * length(x)) { #defined percentage
return(NA)
}
else {
return(mean(x, na.rm = TRUE))
}
}
#Reading temperature information
data_mt <- read.xlsx("DatosIDW_221205.xlsx", "TSSM_D")
#Sorting the temperature data by dates
data_mt <- as.xts(data_mt[ , -1],
order.by = as.Date(data_mt[ , -1],
format = "%Y-%m-%d"))
data_mt <- read.xlsx("DatosIDW_221205.xlsx", "TSSM_D")
#Sorting the temperature data by dates
data_mt <- as.xts(data_mt[ , -1],
order.by = as.Date(data_mt[ , 1],
format = "%Y-%m-%d"))
#Obtaining the annual temperature of each station
data_y_mt <- aggreate(data_mt, by = year(index(data_mt)), agg_mt) %>%
data.frame(check.names = FALSE)
data_mt <- read.xlsx("DatosIDW_221205.xlsx", "TSSM_D")
#Sorting the temperature data by dates
data_mt <- as.xts(data_mt[ , -1],
order.by = as.Date(data_mt[ , 1],
format = "%Y-%m-%d"))
#Obtaining the annual temperature of each station
data_y_mt <- aggregate(data_mt, by = year(index(data_mt)), agg_mt) %>%
data.frame(check.names = FALSE)
View(data_y_mt)
